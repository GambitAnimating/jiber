import { sendToSocket } from './send-to-socket'

////////////////////////////////////////////////////////////////////////////////
// mocks
////////////////////////////////////////////////////////////////////////////////
let calls: any[]
const ws: any = {
  readyState: 1,
  OPEN: 1,
  send: (message: string) => calls.push(message)
}

////////////////////////////////////////////////////////////////////////////////
// setup
////////////////////////////////////////////////////////////////////////////////
beforeEach(() => calls = [])

////////////////////////////////////////////////////////////////////////////////
// tests
////////////////////////////////////////////////////////////////////////////////
test('send stringified action to a socket', () => {
  sendToSocket(ws, { type: 'test' })
  expect(calls).toEqual(['{"type":"test"}'])
})

test('ignore non-existant sockets', () => {
  sendToSocket(ws, { type: 'test' })
  expect(calls).toEqual([])
})
